<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Temp</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.bundle.js"></script>
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
</head>

<style>
    #mybtn, #mybtn2{
        padding: 2px;
        width: 40px;
        border-radius: 10%;
        float: right;
        margin: 0px;
    }
    #width{
        width: 80%;
    }
</style>
<body>

        <nav class="navbar navbar-expand-lg navbar-light bg-light">

                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                  <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                      <a class="nav-link" href="/home">Home<span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item active">
                      <a class="nav-link" href="/department">store<span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item active">
                      <a class="nav-link" href="/devices">Manage your devices<span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item active">
                      <a class="nav-link" href="/Example">Example<span class="sr-only">(current)</span></a>
                    </li>
                  </ul>
                </div>
              </nav>

              <br>

<div class="container">

    <div class="jumbotron d-flex justify-content-center">
        <div id="width">
            <ol class="list-group">
                <li class="list-group-item font-weight-bold txt">
                    Living Room Lights:
                    <button id="mybtn">On</button>
                </li>
                <br>
                <li class="list-group-item font-weight-bold txt">
                    Room Fan:
                    <button id="mybtn2">On</button>
                </li>
            </ol>
        </div>
    </div>
</div>

</body>
<script type="text/javascript">

let bool1, bool2;
let update = {};

temp = function(){
    $.get("api/temp", function(data){
        console.log(data);
    })
}

setInterval(temp, 10000);

$.get("/api/led/", function(req, res){
    console.log(req);

    let pos1 = req[0].position
    let pos2 = req[1].position

    update1 = {
        position: pos1
    }

    update2 = {
        position: pos2
    }

    if(pos1 === 1){
        bool1 = true

        $("#mybtn").css('background', 'green');
        $("#mybtn").text("On");
    }
    else if(pos1 === 0){

        bool1 = false

        $("#mybtn").css('background', 'red');
        $("#mybtn").text("Off");
        
    }

    if(pos2 === 1){
        bool2 = true

        $("#mybtn2").css('background', 'green');
        $("#mybtn2").text("On");
    }
    else if(pos2 === 0){

        bool2 = false

        $("#mybtn2").css('background', 'red');
        $("#mybtn2").text("Off");
    }


})


    function updateLed(id, led) {
    $.ajax("/api/led/" + id, {
      method: "PUT",
      data: led
    }).then(function(){

        console.log("wassup")

    });
  }


$("#mybtn").on('click', function(){

    if(bool1){

        bool1 = false

        $("#mybtn").css('background', 'red');
        $("#mybtn").text("Off");
        
        update.position = 0;

        console.log(update)

        updateLed(1, update);
    }
    else if(!bool1) {

        bool1 = true

        $("#mybtn").css('background', 'green');
        $("#mybtn").text("On");

        update.position = 1;

        console.log(update);

        updateLed(1, update);
    }
})
$("#mybtn2").on('click', function(){

if(bool2){

    bool2 = false

    $("#mybtn2").css('background', 'red');
    $("#mybtn2").text("Off");
    
    update.position = 0;

    console.log(update)

    updateLed(2, update);
}
else if(!bool2) {

    bool2 = true

    $("#mybtn2").css('background', 'green');
    $("#mybtn2").text("On");

    update.position = 1;

    console.log(update);

    updateLed(2, update);
}
})
</script>
</html>